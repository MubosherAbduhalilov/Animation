<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Css Teapot animation</title>
</head>
<body>
    <div class="container" id="container"> 
        <div class="teapot">
            <img src="background.jpg" alt="">
            <div class="jomrak">
                <div class="top2" id="top2">
                    <div class="tea" id="tea">
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            </div>
            <div class="handle"></div>
            <div class="top">
                <div class="qopqoq">
                    <div class="qhandle"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="cup">
        <div class="top3"></div>
        <div class="teaCup" id="cupTea"></div>
        <img src="cupBackground.jpg" alt="">
    </div>
    <script>
        teapotLiftingAnimation()
        var tea = document.getElementById('tea')
        async function sleep(seconds) {
            return new Promise((resolve) => setTimeout(resolve, seconds * 1000));
        }
        async function teapotLiftingAnimation() {
            var con = document.getElementById('container').style
            var duration = 3;
            var alternate = 1;
            while (true){
                if(alternate%2!=0){
                    for(var i=0; i<350; i++) {
                        if (i==210){
                            var audio = new Audio("pouring.mp3")
                            audio.playbackRate = ".75"
                            audio.play();
                        }
                        await sleep(duration/350);
                        if(i>=260){
                            var val = (i-260)/1.8
                            con.transform = "rotateZ(" + "-" + (val).toString() + "deg)"
                            if (i==349) {
                                teaPouringAnimation()
                            }
                        }
                        con.translate = "-" + (i).toString()+"px " + "-" + (i/2).toString()+"px"
                    }
                    await sleep(8)
                    document.getElementById("cupTea").style.animationPlayState = "paused"
                }else{
                    for(var j=350; j>0; j--) {
                        await sleep(duration/350);
                        if(260<=j<=350){
                            con.transform = "rotateZ(" + "-" + ((j-260)/1.8).toString() + "deg)"
                            if (j==20) {
                                tea.children[i].style.background = "transparent"
                                }
                            }
                        con.translate = "-" + (j).toString()+"px " + "-" + (j/2).toString()+"px"
                        }
                        await sleep(1)
                    }
                    alternate++
                }
            }
        async function teaPouringAnimation() {
            var childrenCount = tea.childElementCount
            for(var i=0; i<childrenCount; i++){
                tea.children[i].style.background = "linear-gradient(#c57e65, #e28462)"
                tea.children[i].style.translate = (-1.25*i).toString() + "px 0px"
                await sleep(.01)
                tea.children[i].style.transform = "rotateZ(-60deg)"
            }
            // audio.playbackRate = ".8"
            document.getElementById("cupTea").style.animationPlayState = "running"
            for(var q=0; q<16; q++) {
                for(var i=0; i<childrenCount; i++){
                    // if (q==0){document.getElementById("vapour").children[i].style.animationPlayState = "running"
                    // document.getElementById("vapour").childre n[i].style.visibility = "visible"}
                    tea.children[i].style.background = "transparent"
                    await sleep(.04)
                    if (q!=15){
                    tea.children[i].style.background = "linear-gradient(#c57e65, #e28462)"} 
                }
            }
        }
    </script>
</body>
</html>